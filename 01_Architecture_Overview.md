01. Общая Архитектура Проекта "Tonb riders"

Цель проекта

Создать Telegram Mini App (TMA) игру в жанре "Сапер/Рогалик" с экономической составляющей.
Игрок выступает в двух ролях:

Фараон: Создает карты (гробницы) с ловушками.

Расхититель: Пытается пройти карты других игроков, избегая ловушек.

Технологический стек

Для минимизации ошибок и стабильности работы использовать:

Backend

Язык: Python 3.10+

Фреймворк: Flask (легковесный, идеально для API).

База данных: PostgreSQL (для Production) или SQLite (для разработки). Использовать SQLAlchemy Core или сырой SQL через драйвер psycopg для производительности.

ORM: Не использовать сложные ORM (типа Django ORM), писать чистые оптимизированные SQL запросы.

Frontend

Язык: Vanilla JavaScript (ES6+). Без React/Vue/Angular (чтобы код был "в одном файле" и легко правился).

Стили: CSS3 (Flexbox/Grid), адаптивность под мобильные устройства.

Платформа: Telegram Web Apps SDK (window.Telegram.WebApp).

Принципы работы (Важно!)

Server Authoritative (Сервер — закон):

Клиент никогда не решает, выиграл игрок или проиграл.

Клиент отправляет действие {"action": "dig", "cell": 5}.

Сервер проверяет карту, меняет баланс и возвращает результат {"status": "dead", "reward": 0}.

Безопасность:

Авторизация только через валидацию initData от Telegram.

Никаких user_id в теле запроса, которые можно подменить. User ID берется из расшифрованного токена.

Stateless (Без состояния в памяти):

Сервер не должен хранить состояние игры в оперативной памяти (переменных). Все состояние пишется в БД. Если сервер перезагрузится, игра не должна сломаться.